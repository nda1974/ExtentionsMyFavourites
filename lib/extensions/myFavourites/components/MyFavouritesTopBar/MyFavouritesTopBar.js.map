{"version":3,"sources":["extensions/myFavourites/components/MyFavouritesTopBar/MyFavouritesTopBar.tsx"],"names":[],"mappings":"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","file":"extensions/myFavourites/components/MyFavouritesTopBar/MyFavouritesTopBar.js","sourcesContent":["import * as React from \"react\";\r\nimport * as ReactDOM from \"react-dom\";\r\nimport { DefaultButton, PrimaryButton } from \"office-ui-fabric-react/lib/Button\";\r\nimport { Panel, PanelType } from \"office-ui-fabric-react/lib/Panel\";\r\nimport { Dialog, DialogType, DialogFooter } from 'office-ui-fabric-react/lib/Dialog';\r\nimport { TextField } from 'office-ui-fabric-react/lib/TextField';\r\nimport { Spinner, SpinnerSize } from 'office-ui-fabric-react/lib/Spinner';\r\nimport { MessageBar, MessageBarType } from 'office-ui-fabric-react/lib/MessageBar';\r\nimport { List } from \"office-ui-fabric-react/lib/List\";\r\nimport { FocusZone, FocusZoneDirection } from 'office-ui-fabric-react/lib/FocusZone';\r\nimport { IMyFavouritesTopBarProps } from \"./IMyFavouritesTopBarProps\";\r\nimport { IMyFavouritesTopBarState } from \"./IMyFavouritesTopBarState\";\r\nimport { MyFavouritesService } from \"../../../services/MyFavouritesService\";\r\nimport { IMyFavouriteItem } from \"../../../interfaces/IMyFavouriteItem\";\r\nimport MyFavoutiteDisplayItem from \"../MyFavoutiteDisplayItem/MyFavoutiteDisplayItem\";\r\nimport styles from \"../MyFavourites.module.scss\";\r\n\r\nexport default class MyFavouritesTopBar extends React.Component<IMyFavouritesTopBarProps, IMyFavouritesTopBarState> {\r\n    private _self = this;\r\n    private _MyFavouritesServiceInstance: MyFavouritesService;\r\n    private _MyFavouriteItems: IMyFavouriteItem[] =[];\r\n    constructor(props: IMyFavouritesTopBarProps) {\r\n        super(props);\r\n        this.state = {\r\n            \r\n            showPanel: false,\r\n            showDialog: false,\r\n            dialogTitle: \"\",\r\n            myFavouriteItems: [],\r\n            itemInContext: {\r\n                Id: 0,\r\n                Title: \"\",\r\n                Description: \"\",\r\n                Mandatory:false\r\n            },\r\n            isEdit: false,\r\n            status: <Spinner size={SpinnerSize.large} label=\"Henter...\" />,\r\n            disableButtons: false\r\n        };\r\n\r\n        this._MyFavouritesServiceInstance = new MyFavouritesService(this.props);\r\n        this._getMyFavourites.bind(this);\r\n    }\r\n\r\n    public render(): React.ReactElement<IMyFavouritesTopBarProps> {\r\n        return (\r\n            <div className={styles.ccTopBar}>\r\n                <PrimaryButton data-id=\"menuButton\"\r\n                    title=\"Vis mine favoritter\"\r\n                    text=\"Mine favoritter\"\r\n                    ariaLabel=\"Vis\"\r\n                    iconProps={{ iconName: \"View\" }}\r\n                    className={styles.ccTopBarButton}\r\n                    onClick={this._showMenu.bind(this)}\r\n                />\r\n                <PrimaryButton data-id=\"menuButton\"\r\n                    title=\"Tilføj denne side til 'Mine favoritter'\"\r\n                    text=\"Tilføj\"\r\n                    ariaLabel=\"Tilføj\"\r\n                    iconProps={{ iconName: \"Add\" }}\r\n                    className={styles.ccTopBarButton}\r\n                    onClick={this._showDialog.bind(this)}\r\n                />\r\n                <Panel isOpen={this.state.showPanel}\r\n                    type={PanelType.medium}\r\n                    onDismiss={this._hideMenu.bind(this)}\r\n                    headerText=\"Mine favoritter\"\r\n                    headerClassName={`ms-font-xl ${styles.ccPanelHeader}`}\r\n                    isLightDismiss={ true }\r\n                >\r\n                    <div data-id=\"menuPanel\">\r\n                    <TextField placeholder=\"Filtrer favoritter...\"\r\n                               iconProps={ { iconName: \"Filter\" } }\r\n                               onBeforeChange={ this._onFilterChanged.bind(this) } />\r\n                        <div>\r\n                            {this.state.status}\r\n                        </div>\r\n                        <FocusZone direction={ FocusZoneDirection.vertical }>\r\n                        { this.state.myFavouriteItems.length > 0 ? \r\n                            <List\r\n                                items = { this.state.myFavouriteItems }\r\n                                onRenderCell={ this._onRenderCell.bind(this) }\r\n                            /> :\r\n                            <MessageBar\r\n                                messageBarType={ MessageBarType.warning }\r\n                                isMultiline={ false }>\r\n                                Du har ingen favoritter.\r\n                            </MessageBar>\r\n                        }\r\n                        </FocusZone>\r\n                    </div>\r\n                </Panel>\r\n                <Dialog\r\n                    hidden={!this.state.showDialog}\r\n                    onDismiss={this._hideDialog}\r\n                    dialogContentProps={{\r\n                        type: DialogType.largeHeader,\r\n                        title: this.state.dialogTitle\r\n                    }}\r\n                    modalProps={{\r\n                        titleAriaId: \"myFavDialog\",\r\n                        subtitleAriaId: \"myFavDialog\",\r\n                        isBlocking: false,\r\n                        containerClassName: \"ms-dialogMainOverride\"\r\n                    }}\r\n                >\r\n                    <div>\r\n                        {this.state.status}\r\n                    </div>\r\n                    <TextField label=\"Navn\"\r\n                               onChanged={this._setTitle.bind(this)}\r\n                               value={this.state.itemInContext.Title} />\r\n                    <TextField label=\"Beskrivelse\"\r\n                                multiline rows={4}\r\n                                onChanged={this._setDescription.bind(this)}\r\n                                value={this.state.itemInContext.Description} />\r\n                    <DialogFooter>\r\n                        <PrimaryButton onClick={this._saveMyFavourite.bind(this)}\r\n                                       disabled={this.state.disableButtons}\r\n                                       text=\"Gem\" iconProps={{ iconName: \"Save\" }}\r\n                                       className={styles.ccDialogButton}/>\r\n                        <DefaultButton onClick={this._hideDialog.bind(this)}\r\n                                       disabled={this.state.disableButtons}\r\n                                       text=\"Annuller\"\r\n                                       iconProps={{ iconName: \"Cancel\" }} />\r\n                    </DialogFooter>\r\n                </Dialog>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    //#region CRUD\r\n    public async deleteFavourite(favouriteItemId: number): Promise<void> {\r\n        let result: boolean = await this._MyFavouritesServiceInstance.deleteFavourite(favouriteItemId);\r\n        if (result) {\r\n            this._getMyFavourites();\r\n        }\r\n    }\r\n\r\n    public editFavourite(favouriteItem: IMyFavouriteItem): void {\r\n        console.log(favouriteItem);\r\n        let status: JSX.Element = <span></span>;\r\n        let dialogTitle: string = \"Rediger favorit\";\r\n        this.setState({ ...this.state, showPanel: false, itemInContext: favouriteItem, isEdit: true, showDialog: true, dialogTitle, status });\r\n    }\r\n\r\n    private async _getMyFavourites(): Promise<void> {\r\n        let status: JSX.Element = <Spinner size={SpinnerSize.large} label='Henter...' />;\r\n        this.setState({ ...this.state, status });\r\n\r\n        const myFavouriteItems: IMyFavouriteItem[] = await this._MyFavouritesServiceInstance.getMyFavourites(true);\r\n        console.log(myFavouriteItems)\r\n        this._MyFavouriteItems = myFavouriteItems;\r\n        status = <span></span>;\r\n        this.setState({ ...this.state, myFavouriteItems, status });\r\n    }\r\n\r\n    private async _saveMyFavourite(): Promise<void> {\r\n        let status: JSX.Element = <Spinner size={SpinnerSize.large} label='Henter...' />;\r\n        let disableButtons: boolean = true;\r\n        this.setState({ ...this.state, status, disableButtons });\r\n        let itemToSave: IMyFavouriteItem = {\r\n            Title: this.state.itemInContext.Title,\r\n            Description: this.state.itemInContext.Description,\r\n            Mandatory:false\r\n        };\r\n        let itemToEdit: IMyFavouriteItem = { ...itemToSave, Id: this.state.itemInContext.Id };\r\n        let result: boolean = this.state.isEdit ? await this._MyFavouritesServiceInstance.updateFavourite(itemToEdit) : await this._MyFavouritesServiceInstance.saveFavourite(itemToSave);\r\n        if (result) {\r\n            status = <MessageBar\r\n                        messageBarType={ MessageBarType.success }\r\n                        isMultiline={ false }>\r\n                        Done!\r\n                    </MessageBar>;\r\n        } else {\r\n            status = <MessageBar\r\n                        messageBarType={ MessageBarType.error }\r\n                        isMultiline={ false }>\r\n                        There was an error!\r\n                    </MessageBar>;\r\n        }\r\n        disableButtons = false;\r\n        this.setState({ ...this.state, status, disableButtons });\r\n    }\r\n    //#endregion\r\n\r\n    //#region Render related\r\n    private _showMenu(): void {\r\n        this._getMyFavourites();\r\n        this.setState({ showPanel: true });\r\n    }\r\n\r\n    private _hideMenu(): void {\r\n        this.setState({ showPanel: false });\r\n    }\r\n\r\n    private _showDialog(): void {\r\n        let itemInContext: IMyFavouriteItem = {\r\n            Id: 0,\r\n            Title: \"\",\r\n            Description: \"\",\r\n            Mandatory:false\r\n        };\r\n        let isEdit: boolean = false;\r\n        let status: JSX.Element = <span></span>;\r\n        let dialogTitle: string = \"Tilføj til mine favoritter\";\r\n        this.setState({ ...this.state, itemInContext, isEdit, showDialog: true, dialogTitle, status });\r\n    }\r\n\r\n    private _hideDialog(): void {\r\n        this.setState({ showDialog: false });\r\n    }\r\n\r\n    private _onRenderCell(myFavouriteItem: IMyFavouriteItem, index: number | undefined): JSX.Element {\r\n        let animationClass: string = `ms-slideDownIn20`;\r\n        return (\r\n            <div className={`${animationClass} ${styles.ccitemCell}`} data-is-focusable={ true }>\r\n                 <MyFavoutiteDisplayItem\r\n                    displayItem={myFavouriteItem}\r\n                    deleteFavourite={this.deleteFavourite.bind(this)}\r\n                    editFavoutite={this.editFavourite.bind(this)} />\r\n            </div>\r\n        );\r\n    }\r\n\r\n    private _onFilterChanged(text: string): void {\r\n        let items: IMyFavouriteItem[] = this._MyFavouriteItems;\r\n        this.setState({\r\n            myFavouriteItems: text ?\r\n            items.filter(item => item.Title.toLowerCase().indexOf(text.toLowerCase()) >= 0) :\r\n            items\r\n        });\r\n    }\r\n\r\n    //#endregion\r\n\r\n    private _setTitle(value: string): void {\r\n        let itemInContext: IMyFavouriteItem = this.state.itemInContext;\r\n        itemInContext.Title = value;\r\n        this.setState({ ...this.state, itemInContext });\r\n    }\r\n\r\n    private _setDescription(value: string): void {\r\n        let itemInContext: IMyFavouriteItem = this.state.itemInContext;\r\n        itemInContext.Description = value;\r\n        this.setState({ ...this.state, itemInContext });\r\n    }\r\n\r\n}\r\n\r\n"],"sourceRoot":"..\\..\\..\\..\\..\\src"}